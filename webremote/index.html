<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>tvPlayer</title>
    <link rel="stylesheet" href="./styles.css?v=250529-E" />
    <script src="./md5.min.js?v=250529-E"></script>
    <script src="./mqtt.min.js?v=250529-E"></script>
    <script src="./scripts.js?v=250529-E" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
</head> 

<body>
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <img src="./assets/logo.png?v=250528-B" alt="Logo" style="height: 40px; margin-left:-8px">
            <div class="heartbeatContainer" onclick="showState()">
                <div>
                    <div id="heartbeat"></div>
                </div>
            </div>
        </div>

        <div id="display" class="display" onclick="gebi('playstate').src='assets/icons/timer-sand.svg'; sendCommand({'cmd': 'toggle_play'})">
            <div>
                <img id="playstate" src="./assets/icons/help-rhombus-outline.svg">
            </div>
        </div>
        <div class="playerInfo">
            <div id="currentFile" class="small">No current file. Insert USB with valid video or image files.</div>
            <div style="position: relative;">
                <input type="range" id="timeline" value="0" min="0" max="160" step=".1" 
                    oninput="skipperPreviewTime(this)"
                    onchange="skipper(this.value)"
                >
                <div id="timecode">00:00.0/00:00.0</div>
            </div>
        </div>

        <div class="control-group">
            <!-- MAIN CONTROL -->
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'prev_channel'})">
                    <img src="assets/icons/skip-previous.svg">
                </button>
                <button onclick="setToWait('playstate'); sendCommand({'cmd': 'toggle_play'})" style="width:250%">
                    <img src="assets/icons/play-pause.svg">
                </button>
                <button onclick="sendCommand({'cmd': 'next_channel'})">
                    <img src="assets/icons/skip-next.svg">
                </button>
            </div>

            <!-- SEEKING -->
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'seek', 'value': -60})">
                    <img src="assets/icons/rewind.svg"><sup class="small">-1m</sup>
                </button>
                <button onclick="sendCommand({'cmd': 'seek', 'value': -5})">
                    <img src="assets/icons/step-backward-2.svg"><sup class="small">-5s</sup>
                </button>
                <button onclick="sendCommand({'cmd': 'seek', 'value': -0.04})">
                    <img src="assets/icons/step-backward.svg"><sup class="small">-f</sup>
                </button>
                <button onclick="sendCommand({'cmd': 'seek', 'value': 0.04})">
                    <img src="assets/icons/step-forward.svg"><sup class="small">+f</sup>
                </button>
                <button onclick="sendCommand({'cmd': 'seek', 'value': 5})">
                    <img src="assets/icons/step-forward-2.svg"><sup class="small">+5s</sup>
                </button>
                <button onclick="sendCommand({'cmd': 'seek', 'value': 60})">
                    <img src="assets/icons/fast-forward.svg"><sup class="small">+1m</sup>
                </button>
            </div>
            <!-- PLAYBACK SPEED -->
            <div class="button-row" style="margin: 2em 0;">
                <button onclick="sendCommand({'cmd': 'adjust_video_speed', 'value': -0.1})">
                    <img src="assets/icons/speedometer-slow.svg"><sup>-</sup>
                </button>
                <button onclick="sendCommand({'cmd': 'adjust_video_speed', 'value': 'reset'})" style="width:250%">
                    Speed <img src="assets/icons/speedometer-medium.svg"> reset
                </button>
                <button onclick="sendCommand({'cmd': 'adjust_video_speed', 'value': 0.1})">
                    <img src="assets/icons/speedometer.svg"><sup>+</sup>
                </button>
            </div>

            Files on USB:
            <div id="filelist" class="grey">
                No valid files on USB or no USB plugged.

                <!-- <div class="button-row"><button class="filelistButton"><img class="thumbnails" src="./thumbnails/test.jpg">#1: 01<span class="grey">.mp4</span></button></div>
                <div class="button-row"><button class="filelistButton"><img class="thumbnails" src="./thumbnails/test.jpg">#2: asdfasdf_ASDfasdfasdfasdf_ASdfasdfasdf-asDF_ASD_fASD_f_sdfA_sdF<span class="grey">.mp4</span></button></div>
                <div class="button-row"><button class="filelistButton"><img class="thumbnails" src="./thumbnails/test.jpg">#3: asd fasdf sadfasdf asdf asdfasdf asdfasd fasefr awert fasdf sdf asdf sadf asdf<span class="grey">.mp4</span></button></div> -->
            </div>

            
        </div>

        <div class="control-group">
            <h2>A&rarr;B loop</h2>
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'set_inpoint'})">Set A <img src="assets/icons/ray-start-arrow.svg"></button>
                <button onclick="sendCommand({'cmd': 'set_outpoint'})"><img src="assets/icons/ray-end-arrow.svg"> Set B</button>
            </div>
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'clear_inpoint'})">Clear A <img src="assets/icons/ray-start-arrow-close.svg"></button>
                <button onclick="sendCommand({'cmd': 'clear_outpoint'})"><img src="assets/icons/ray-end-arrow-close.svg"> Clear B</button>
            </div>
        </div>

        <div class="control-group">
            <h2>Fill colors</h2>
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'toggle_black_screen'})">Toggle Black Screen</button>
                <button onclick="sendCommand({'cmd': 'cycle_white_noise'})">Set Noise Style</button>
            </div>
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'cycle_green_screen', 'value': -1})">Green Style -</button>
                <button onclick="sendCommand({'cmd': 'cycle_green_screen', 'value': 0})">Toggle Green Screen</button>
                <button onclick="sendCommand({'cmd': 'cycle_green_screen', 'value': 1})">Green Style +</button>
            </div>
        </div>

        <div class="control-group">
            <h2>Image adjustment</h2>
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'set_video_fitting'})">
                    Cycle Video Fittings
                    <img src="assets/icons/view-array-outline.svg">
                </button>
            </div>
            <div class="button-row">
                <div class="buttonNote" id="note-brightness" title="brightness">100</div>
                <div class="buttonNote" id="note-contrast" title="contrast">100</div>
                <div class="buttonNote" id="note-saturation" title="saturation">100</div>
            </div>
            <div class="button-row">
                <button onclick="setToWait('note-brightness'); sendCommand({'cmd': 'adjust_video_brightness', 'value': -5}, false, true)">
                    <img src="assets/icons/brightness-6.svg"><sup>-</sup>
                </button>
                <button onclick="setToWait('note-brightness'); sendCommand({'cmd': 'adjust_video_brightness', 'value': 5}, false, true)">
                    <img src="assets/icons/brightness-6.svg"><sup>+</sup>
                </button>
                <button onclick="setToWait('note-contrast'); sendCommand({'cmd': 'adjust_video_contrast', 'value': -5}, false, true)">
                    <img src="assets/icons/image-filter-black-white.svg"><sup>-</sup>
                </button>
                <button onclick="setToWait('note-contrast'); sendCommand({'cmd': 'adjust_video_contrast', 'value': 5}, false, true)">
                    <img src="assets/icons/image-filter-black-white.svg"><sup>+</sup>
                </button>
                <button onclick="setToWait('note-saturation'); sendCommand({'cmd': 'adjust_video_saturation', 'value': -5}, false, true)">
                    <img src="assets/icons/palette.svg"><sup>-</sup>
                </button>
                <button onclick="setToWait('note-saturation'); sendCommand({'cmd': 'adjust_video_saturation', 'value': 5}, false, true)">
                    <img src="assets/icons/palette.svg"><sup>+</sup>
                </button>
            </div>
            <div class="button-row" style="margin:2em 0">
                <button onclick="sendCommand({'cmd': 'zoom', 'value': -0.01})">
                    <img src="assets/icons/magnify-minus.svg">
                </button>
                <button onclick="sendCommand({'cmd': 'zoom', 'value': 0})" style="width:250%">
                    Zoom <img src="assets/icons/magnify.svg"> reset</button>
                <button onclick="sendCommand({'cmd': 'zoom', 'value': 0.01})">
                    <img src="assets/icons/magnify-plus.svg">
                </button>
            </div>
            <div class="button-row">
                <button 
                    onmousedown="startPan(event, 'x', -1)"
                    onmouseup="stopPan(event, 'x', -1)"
                    onmouseleave="stopPan(event, 'x', -1)"
                    ontouchstart="startPan(event, 'x', -1)"
                    ontouchend="stopPan(event, 'x', -1)"
                >Move Left</button>
                <button onclick="sendCommand({'cmd': 'pan', 'value': ['reset', 'x']})">
                    Reset <img src="assets/icons/arrow-left-right.svg">
                </button>
                <button 
                    onmousedown="startPan(event, 'x', 1)"
                    onmouseup="stopPan(event, 'x', 1)"
                    onmouseleave="stopPan(event, 'x', 1)"
                    ontouchstart="startPan(event, 'x', 1)"
                    ontouchend="stopPan(event, 'x', 1)"
                >Move Right</button>
            </div>
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'pan_reset'})">
                    Reset <img src="assets/icons/arrow-all.svg">
                </button>
            </div>
            <div class="button-row">
                <button 
                    onmousedown="startPan(event, 'y', -1)"
                    onmouseup="stopPan(event, 'y', -1)"
                    onmouseleave="stopPan(event, 'y', -1)"
                    ontouchstart="startPan(event, 'y', -1)"
                    ontouchend="stopPan(event, 'y', -1)"
                >Move Up</button>
                <button onclick="sendCommand({'cmd': 'pan', 'value': ['reset', 'y']})">
                    Reset <img src="assets/icons/arrow-up-down.svg">
                </button>
                <button 
                    onmousedown="startPan(event, 'y', 1)"
                    onmouseup="stopPan(event, 'y', 1)"
                    onmouseleave="stopPan(event, 'y', 1)"
                    ontouchstart="startPan(event, 'y', 1)"
                    ontouchend="stopPan(event, 'y', 1)"
                >Move Down</button>
            </div>
        </div>

        <div class="control-group">
            <h2>Look & feel</h2>
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'toggle_show_tv_gui'})">
                    Toggle TV channel numbers
                    <img src="assets/icons/tv-gui.svg">
                </button>
                <button onclick="sendCommand({'cmd': 'toggle_white_noise_on_channel_change'})">
                    Toggle white noise between channel changes
                    <img src="assets/icons/gradient-vertical.svg">
                </button>
            </div>
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'adjust_volume', 'value': -10})">
                    <img src="assets/icons/volume-minus.svg">
                </button>
                <button onclick="sendCommand({'cmd': 'adjust_volume', 'value': 10})">
                    <img src="assets/icons/volume-plus.svg">
                </button>
            </div>
        </div>

        <div class="control-group">
            <h2>System</h2>
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'shutdown'})">
                    Shutdown
                    <img src="assets/icons/power.svg">
                </button>
                <button onclick="sendCommand({'cmd': 'reboot'})">
                    Reboot
                    <img src="assets/icons/restart.svg">
                </button>
            </div>
        </div>

        <div class="control-group small grey" style="text-align: center;">
            tvPlayer by Fabian Lüscher with <img src="assets/icons/heart-box.svg" style="height:1.5em; opacity: .7; vertical-align: middle;"> @ 2025
            <div class="small">www.fluescher.ch</div>
        </div>

        <div class="control-group">
            <h2>Admin</h2>
            <div class="button-row">
                <button onclick="sendCommand({'cmd': 'toggle_fullscreen'})">Toggle Fullscreen</button>
                <button onclick="sendCommand({'cmd': 'close_program'})">Exit to Desktop</button>
                <a href="http://10.3.141.1" target="_blank"><button>RaspAP&nbsp;Admin</button></a>
            </div>
            <h2 style="margin-top:2em;">MQTT Console</h2>
            <div id="console" class="maxHeight400" style="font-family: 'Courier New', Courier, monospace; font-size: .8em; line-height: 1.5em;">Init</div>
        </div>
    </div>
</body>

</html>